<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/css/trivia.css" />
    <title>üåπ MINI TRIVIA ROM√ÅNTICA</title>
  </head>
  <body>
    <!-- üåπ MINI TRIVIA ROM√ÅNTICA -->
    <section
      class="container p-2"
      style="height: 100vh !important; background-color: #ff5a5a"
    >
      <div class="card shadow-sm p-3 text-center bg-dark text-white h-100">
        <h2 class="mb-3 mt-5 fs-5">üíû Mini Trivia üíû</h2>

        <div id="triviaBox" class="h-100">
          <h5 id="question" class="fs-6"></h5>
          <div id="options" class="mt-5 mb-5" style="height: 10%"></div>
          <p id="progress" class="text-muted mt-2 small"></p>
        </div>

        <div id="resultBox" class="d-none">
          <h4 id="resultTitle" class="fs-6"></h4>
          <p id="scoreText" class="mb-2 small"></p>
          <button id="restartBtn" class="btn btn-primary btn-sm">
            Volver a jugar
          </button>
        </div>

        <div id="reactionBox" class="d-none mt-3">
          <div id="reactionContent"></div>
        </div>
      </div>
    </section>

    <script>
      const trivia = [
        {
          question: "como te sentis conmigo?",
          options: ["mal", "comoda", "bien", "adoro todo de ti"],
          correct: "",
        },
        {
          question: "sale siesta juntos?",
          options: ["si obvi", "nop"],
          correct: "si obvi",
        },
        {
          question: "que me gusta mas de ti",
          options: [
            "tu risa",
            "tus besos, me encantan",
            "tu pensamiento del amor",
          ],
          correct: [
            "tu risa",
            "tus besos, me encantan",
            "tu pensamiento del amor",
          ],
        },
        {
          question: "Tenes hambre despu√©s de verme?",
          options: ["si obvi", " nop", "tal vez"],
          correct: "si obvi",
        },
      ];

      let currentQuestion = 0;
      let score = 0;

      const questionEl = document.getElementById("question");
      const optionsEl = document.getElementById("options");
      const progressEl = document.getElementById("progress");
      const resultBox = document.getElementById("resultBox");
      const resultTitle = document.getElementById("resultTitle");
      const scoreText = document.getElementById("scoreText");
      const restartBtn = document.getElementById("restartBtn");
      const reactionBox = document.getElementById("reactionBox");
      const reactionContent = document.getElementById("reactionContent");

      function showQuestion() {
        const q = trivia[currentQuestion];
        questionEl.textContent = q.question;
        optionsEl.innerHTML = "";
        q.options.forEach((opt) => {
          const btn = document.createElement("button");
          btn.classList.add(
            "btn",
            "btn-outline-primary",
            "w-100",
            "h-100",
            "mb-5",
            "btn-sm"
          );
          btn.textContent = opt;
          btn.onclick = () => checkAnswer(opt);
          optionsEl.appendChild(btn);
        });
        progressEl.textContent = `Pregunta ${currentQuestion + 1} de ${
          trivia.length
        }`;
      }

      function checkAnswer(selected) {
        const q = trivia[currentQuestion];
        const buttons = optionsEl.querySelectorAll("button");

        buttons.forEach((btn) => {
          btn.disabled = true;
          if (
            (Array.isArray(q.correct) && q.correct.includes(btn.textContent)) ||
            btn.textContent === q.correct
          ) {
            btn.classList.replace("btn-outline-primary", "btn-success");
          } else if (
            btn.textContent === selected &&
            !(Array.isArray(q.correct) && q.correct.includes(selected)) &&
            selected !== q.correct
          ) {
            btn.classList.replace("btn-outline-primary", "btn-danger");
          }
        });

        if (
          (Array.isArray(q.correct) && q.correct.includes(selected)) ||
          selected === q.correct
        ) {
          score++;
        }

        setTimeout(() => {
          if (currentQuestion === trivia.length - 1) {
            handleLastQuestionReaction(selected);
            return;
          }
          currentQuestion++;
          if (currentQuestion < trivia.length) {
            showQuestion();
          } else {
            showResult();
          }
        }, 900);
      }

      function handleLastQuestionReaction(selected) {
        document.getElementById("triviaBox").classList.add("d-none");
        reactionBox.classList.remove("d-none");
        reactionContent.innerHTML = "";

        if (selected === "si obvi" || selected === "tal vez") {
          reactionContent.innerHTML = `
            <div class="fade-in">
              <p class="mb-2 fs-6">bueno veni de devorame de nuevo 7w7</p>
              <img src="/img/kissmebottom.png"
                   alt="Ben Porel"
                   class="img-fluid rounded shadow-sm"
                   style="max-width: 180px; border-radius: 1.rem;">
              <div class="mt-2">
                <a href="https://wa.me/+543812168577" target="_blank" class="btn btn-success btn-sm">
                  Ir a WhatsApp üíö
                </a>
              </div> 
            </div>
          `;
        } else if (selected === "No") {
          reactionContent.innerHTML = `<p class="text-muted fs-6">ASI ME GUSTAS!!</p>`;
        }
      }

      function showResult() {
        document.getElementById("triviaBox").classList.add("d-none");
        resultBox.classList.remove("d-none");
        resultTitle.textContent = "üí´ Resultado üí´";
        scoreText.textContent = `Acertaste ${score} de ${trivia.length} preguntas.`;
      }

      restartBtn.onclick = () => {
        currentQuestion = 0;
        score = 0;
        reactionBox.classList.add("d-none");
        document.getElementById("triviaBox").classList.remove("d-none");
        resultBox.classList.add("d-none");
        showQuestion();
      };

      // Animaci√≥n fade-in
      const style = document.createElement("style");
      style.innerHTML = `
        .fade-in { animation: fadeIn 0.6s ease-in; }
        @keyframes fadeIn { from {opacity: 0;} to {opacity: 1;} }
      `;
      document.head.appendChild(style);

      showQuestion();
    </script>
  </body>
</html>
